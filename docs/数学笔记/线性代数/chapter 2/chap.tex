\ifx\allfiles\undefined
\documentclass[12pt, a4paper, oneside, UTF8]{ctexbook}
\usepackage{multirow}
\def\path{../../config}
\input{../../config/_config}
\begin{document}
% \input{../config/cover}
\else
\fi

\chapter{矩阵}
$$
\fbox{
    \begin{tabular}{c}
        矩 \\
        阵
    \end{tabular}
}\begin{cases}
    \fbox{基本运算}\qquad\qquad A+B\qquad kA\qquad AB\qquad A^T \\
    \fbox{逆}\qquad\qquad \begin{cases}
        \fbox{定义} \\
        \fbox{性质} \\
        \fbox{求法} \begin{cases}
            \text{定义法} \\
            \text{初等变换法} \\
            \text{伴随矩阵法} \\
            \text{分块矩阵法}
        \end{cases} \\
        \fbox{充要条件} \begin{cases}
            \iff \left|A\right|\neq 0 \\
            \iff r(A) = n \\
            \iff A\text{的列(行)向量组线性无关} \\
            \iff \text{齐次线性方程组}Ax=0\text{只有零解} \\
            \iff \text{非齐次方程组}Ax=b\text{有唯一解} \\
            \iff A\text{的特征值均不为零}
        \end{cases}
    \end{cases}\\
    \fbox{秩} \begin{cases}
        \fbox{定义} \\
        \fbox{性质} \\
        \fbox{求法}
    \end{cases}
\end{cases}
$$

$$
\fbox{
    \begin{tabular}{c}
        矩 \\
        阵
    \end{tabular}
}\begin{cases}
    \fbox{伴随矩阵} \begin{cases}
    \fbox{定义} \\
    \fbox{性质}
    \end{cases} \\
    \fbox{初等变换与初等矩阵}\begin{cases}
        \fbox{定义} \\
        \fbox{性质} \\
        \fbox{应用}\begin{cases}
            \text{求矩阵的逆} \\
            \text{求矩阵的秩} \\
            \text{线性表示} \\
            \text{求极大线性无关组} \\
            \text{解线性方程组} \\
            \text{求二次型的标准型}
        \end{cases}
    \end{cases} \\
    \fbox{分块矩阵}
\end{cases}
$$
\section{求高次幂}
\begin{remark}
    基本方法 \\
    (1) 若$r(A)=1$,则$A^n=tr(A)^{n-1}A$, 关键点在于$r(A)=1\implies A=\alpha\beta^T$ \\
    (2) 若$A$可以分解为$E+B$,且$B$是类似于如下形式(非零元素仅在对角线的上方或下方)的矩阵则有如下结论.
    \[
    B=\left(
    \begin{array}{ccc}
        0& a& b \\
        0& 0& c \\
        0& 0& 0 \\
    \end{array}\right),
    \text{则}B^2=\left(\begin{array}{ccc}
        0& 0& ac \\
        0& 0& 0 \\
        0& 0& 0 \\
    \end{array}\right), B^3 = \mathbf{0}
    \]
    $A^n=C_{n}^{n}E+C_{n}^{1}B+C_{n}^{2}B^2$ \\
    (3) 分块矩阵
    \[
        A=\left(\begin{array}{cc}
        \mathbf{B} & \mathbf{0} \\
        \mathbf{0} & \mathbf{C}
    \end{array}\right), 
    A^n=\left(\begin{array}{cc}
        \mathbf{B}^n & \mathbf{0} \\
        \mathbf{0} & \mathbf{C}^n
    \end{array}\right)
    \] 
    (4) 相似对角化 \\
    $P^{-1}AP=\Lambda$则$A=P\Lambda P^{-1}$,
    \[
    A^n=P\Lambda^n P^{-1}=P diag(\lambda_1^n,\ldots,\lambda_n^n)P^{-1}
    \]
\end{remark}
\begin{enumerate}
    % 例题2.1
    \item 设 A=$\left(\begin{array}{rrr}
        2&-1&3\\
        a&1&b\\
        4&c&6
    \end{array}\right)$,
        $ B $ 为3阶矩阵,满足 $ BA = O $,且 $ r(B) > 1 $,则 $ A^n =\_\_\_\_$.
    \begin{solution}
    由$BA=0$知$r(A)+r(B)\leq n$,又$r(B)>1,r(A)\geq 1$所以$1\leq r(A)\leq 1,\implies r(A)=1$,
    \begin{align*}
        A=\left(\begin{array}{rrr}
        2&-1&3\\
        a&1&b\\
        4&c&6
    \end{array}\right)=\begin{pmatrix}
        2\\
        -1\\
        3
    \end{pmatrix}\begin{pmatrix}
        1,&-1,&2
    \end{pmatrix} \\
    A^n=tr(A)^{n-1}\alpha\beta^{T}=9^{n-1}\begin{pmatrix}
        2& -1& 3\\
        -2& 1& -3\\
        4& -2& 6
    \end{pmatrix}
    \end{align*}
    \end{solution}
    % 例题2.2
    \item 设$
    A = \begin{pmatrix}
    2 & 0 & 0 \\
    0 & 2 & 0 \\
    4 & 1&  2
    \end{pmatrix}$
    则 $ A^n = $ \underline{\hspace{3cm}}.
    
    \begin{solution}
    $A=2E+B$,$B=\begin{pmatrix}
        0& 0& 0\\
        -3& 0& 0\\
        4& 1& 0
    \end{pmatrix}$, $B^2=\begin{pmatrix}
        0& 0& 0\\
        0& 0& 0\\
        -3& 0& 0
    \end{pmatrix}$, $B^3=\mathbf{0}$,则
    \[
    A^n=2^nE+2^{n-1}nB+2^{n-3}n(n-1)B^2
    \]
    \end{solution}
    
    % 例题2.3
    \item 设
    $A = \begin{pmatrix}
    -1 & 2 & -1 \\
    -1 & 2 & -1 \\
    -3 & 6 & -3
    \end{pmatrix}$
    $ P $ 为3阶可逆矩阵,$ B = P^{-1}AP $,则 $ (B + E)^{100} =\_\_\_\_ $ 
    
    \begin{solution}
    $r(A)=1, A^2=tr(A)\cdot A=-2A$即$A^2+2A=\mathbf{0}, (A+E)^2=E$,由题 \\
    $(B+E)^{100}=(P^{-1}AP+E)^{100}=(P^{-1}AP+P^{-1}EP)^{100}=(P^{-1}(A+E)P)^{100}=E$
    \end{solution}
\end{enumerate}

\section{逆的判定与计算}

\begin{enumerate}
    % 例题2.4
    \item 设 $ n $ 阶矩阵 $ A $ 满足 $ A^2 = 2A $,则下列结论不正确的是： \\
    (A) $A$可逆 \qquad (B) $A-E$可逆\qquad (C)$A+E$可逆\qquad (D)$A-3E$可逆 
    \begin{solution}
    利用特征值,由题设可知对于$A$的任意特征值有
    $$
        \lambda ^ 2 - 2\lambda = 0 \implies \lambda = 0 \text{或} \lambda = 2
    $$
    故B,C,D的特征值分别是  
    $$
        \lambda_B:\begin{cases}
            -1 \\
            1 
        \end{cases}, \lambda_C\begin{cases}
            1 \\
            3 
        \end{cases},\lambda_D\begin{cases}
            -3 \\
            -1
        \end{cases}
    $$
    由可逆的充分条件可知BCD均可逆
    \end{solution}
    
    % 例题2.5
    \item 设 $ A, B $ 为 $ n $ 阶矩阵,$ a, b $ 为非零常数.证明：
    \begin{enumerate}
        \item[(1)] 若 $ AB = aA + bB $,则 $ AB = BA $;
        \item[(2)] 若 $ A^2 + aAB = E $,则 $ AB = BA $.
    \end{enumerate}
    
    \begin{solution}
    (1) 
    \begin{align*}
        AB = aA + bB& \\
        A(B-aE) - bB = 0& \\
        (A-bE)(B-aE)=abE &\implies (A-bE),(B-aE)\text{可逆} \\
        (B-aE)(A-bE)=abE& \\
        BA=aA+bB=AB&
    \end{align*}
    (2) 
    \begin{align*}
        A^2+aAB=E &\\
        A(A+aE)=E &\implies (A+aE)A = E \implies AB=BA
    \end{align*}
    \end{solution}
    
    \begin{tcolorbox}[title=总结]
    (1)$A_{n\times n}B_{n\times n}=E\implies\begin{cases}
        \text{可逆}\\
        \text{求逆}, B=A^{-1}, A=B^{-1} \\
        \text{满足交换律},AB=BA
    \end{cases}$ \\
    (2)$AB$可交换的充分条件$\begin{cases}
        B=f(A),A^{-1},A^* \\
        AB=aA+bB(a,b\neq 0) \\
        A^2+aAB=E,(a\neq 0)
    \end{cases}$
    \end{tcolorbox}
    % 例题2.6
    \item 设 
    $A = \begin{pmatrix}
    a & 1 & 0 \\
    1 & a & -1 \\
    0 & 1 & a
    \end{pmatrix}$
    满足 $ A^3 = O $.
    \begin{enumerate}
        \item[(1)] 求 $ a $ 的值；
        \item[(2)] 若矩阵 $ X $ 满足 $ X - XA^2 - AX + AXA^2 = E $,求 $ X $.
    \end{enumerate}
    
    \begin{solution}
    (1)由$A^3=0\implies \lambda^3=0 \implies \lambda_i = 0 $ 又$\displaystyle tr(A)=\sum_{i=0}^{3}\lambda_i$ 故$a=0$ \\
    (2) 
    \begin{align*}
        \text{原式} &= X(E-A^2)-AX(E-A^2) \\
        &=(E-A)X(E-A^2) = E
    \end{align*}
    有$E-A,E-A^2$均可逆(用特征值)故 
    $$
    X=(E-A)^{-1}(E-A^2)^{-1} 
    $$
    通过初等行变换化为行最简型有 
    \begin{align*}
        \left(E-A-A^2 \mid E\right) \xlongequal{\text{初等行变换}}& \left(E\mid (E-A-A^2)^{-1}\right) \\
        &= \left(\begin{array}{ccc|ccc}
            1 & 0 & 0 & 3 & 1 & -2 \\
            0 & 1 & 0 & 1 & 1 & -1 \\
            0 & 0 & 1 & 2 & 1 & -1
        \end{array}\right)
    \end{align*}
    \end{solution}
\end{enumerate}

\section{秩的计算与证明}
\begin{remark}[秩]
    秩的定义:$\exists r$阶子式非零且$\forall r+1$阶子式均为零 \\
    秩的性质
    \begin{enumerate}
    \item[(1)] 设$A$为$m\times n$阶矩阵,则$r(A)<\min\{m,n\}$
    \item[(2)] $r(A+B)\leq r(A)+r(B)$
    \item[(3)] $r(AB)\leq\min\{r(A),r(B)\}$
    \item[(4)] $\max\{r(A),r(B)\}\leq r(A\mid B)\leq r(A) + r(B)$
    \item[(5)] $r(A)=r(kA)(k\neq 0)$
    \item[(6)] 设$A$为$m\times n$阶矩阵,$P$为$m$阶可逆矩阵,$Q$为$n$阶可逆矩阵,则
    $r(A)=r(PA)=r(AQ)=r(PAQ)$
    \item[(7)] 设$A$为$m\times n$阶矩阵,若$r(A)=n$则$r(AB)=r(B)$,若$r(A)=m$则$r(CA)=r(C)$ \\
    左乘列满秩,右乘行满秩,秩不变
    \item[(8)] $r(A)=r(A^T)=r(A^TA)=r(AA^T)$
    \item[(9)] 设$A$为$m\times n$阶矩阵, $B$为$n\times s$阶矩阵,$AB=0$,则$r(A)+r(B)\leq n$
    \end{enumerate}
\end{remark}
\begin{enumerate}
    \item (2018, 数一、二、三) 设 $ A, B $ 为 $ n $ 阶矩阵,$ (XY) $ 表示分块矩阵,则：
    \begin{enumerate}
        \item[A] $ r(A\ AB) = r(A) $
        \item[B] $ r(A\ BA) = r(A) $
        \item[C] $ r(A\ B) = \max\{r(A), r(B)\} $
        \item[D] $ r(A\ B) = r(A^T B^T) $
    \end{enumerate}
    
    \begin{solution}
    (方法一) 由性质4,联立的秩大于等于每一个有
    $$
    r\left[A(E,B)\right] \geq r(A)
    $$
    由性质3,乘积的秩小于等于每一个有
    $$
    r\left[A(E,B)\right] \leq r(A)
    $$
    故A选项正确 \\
    易错点,B选项为啥不能写成
    $$
    r\left[(E+B)A\right] 
    $$
    其中$(E+B)_{n\times 2n},A_{n\times 2}$ 列$\neq$行无法乘 \\
    (方法二) 
    $$
    r(A,AB)=r\left[A(E,B)\right]
    $$
    其中$(E,B)$显然\underline{行满秩},由性质7右乘行满列则秩不变,即
    $$
    r(A,AB)=r(A) 
    $$
    (方法三)
    $$
    AB=\left(\alpha_1,\alpha_2,\ldots,\alpha_n\right)\begin{pmatrix}
        b_{11} & \ldots & b_{1n} \\
        \vdots & \ldots & \vdots \\
        b_{n1} & \ldots & b_{nn}
    \end{pmatrix} = \left(b_{11}\alpha_1+\ldots+b_{n1}\alpha_n,\ldots,b_{1n}\alpha_1+\ldots+b_{nn}\alpha_n\right)
    $$
    即$AB$的列向量可以由$A$的列向量线性表示,故由极大无关组的定义有
    $$
    r(A,AB)=r(A)
    $$
    (方法四)\ 广义初等变化(分块矩阵) 
    $$
    (A,AB)=(A,O)\begin{pmatrix}
        E & B \\
        O & E 
    \end{pmatrix} \implies r(A,AB)=r(A,O)=r(A)
    $$
    \end{solution}

    \item 设$A$为$n$阶矩阵,证明:
    \begin{enumerate}
        \item [(1)] 若 $ A^2 = A $,则 $ r(A) + r(A - E) = n $.
        \item [(II)] 若 $ A^2 = E $,则 $ r(A + E) + r(A - E) = n $.
    \end{enumerate}
    
    \begin{solution}
    证明第二个,第一个和第二个基本一致. 由$A^2=E$有$(A+E)(A-E)=0$故
    $$
    r(A+E)+r(A-E)\leq n 
    $$
    又
    $$
    r(A+E)+r(A-E) = r(A+E)+r(E-A) \geq r(2E) = n
    $$
    因此$r(A+E)+r(A-E)=n$
    \end{solution}

    \begin{tcolorbox}
        若$A$的二次方程有两个互异根,则因式分解后,秩的和为$n$
    \end{tcolorbox}
\end{enumerate}

\section{关于伴随矩阵}
\begin{remark}
    伴随矩阵的性质
    \begin{enumerate}
    \item[(1)] $AA^*=A^*A=\left|A\right|\xrightarrow{|A|\neq 0}A^{-1}=\frac{1}{|A|}A^*,A^*=|A|A^{-1}$
    \item[(2)] $(kA)^*=k^{n-1}A^*$
    \item[(3)] $(AB)^*=B^*A^*$
    \item[(4)] $|A^*|=\left|A\right|^{n-1}$
    \item[(5)] $(A^T)^*=(A^*)^T$
    \item[(6)] $(A^{-1})^*=(A^*)^{-1}=\frac{A}{\left|A\right|}$
    \item[(7)] $(A^*)^*=\left|A\right|^{n-2}A$
    \item[(8)] 
    $r(A)=
    \begin{cases}
        n,& r(A)=n\\
        1,& r(A)=n-1\\
        0,& r(A)<n-1
    \end{cases}
    $
    \end{enumerate}       
\end{remark}
\begin{enumerate}
    \item 设 $ n $ 阶矩阵 $ A $ 的各列元素之和均为 2,且 $ |A| = 6 $,则 $ A^* $ 的各列元素之和均为：\\
    (A) 2\qquad (B) $\frac{1}{3}$\qquad (C) 3\qquad (D)6
    
    \begin{solution}
    由题设有
    $$
    \left(1,\ldots,1\right)A = 2(1,\ldots, 1)
    $$
    两边同时右乘$A^*$即
    $$
    (1,\ldots,1)A^*=3(1,\ldots,1)
    $$
    故$A^{*}$的各列元素之和均为3
    \end{solution}
    \begin{tcolorbox}[title=各行/列元素之和]
        (各行元素之和为$\lambda$)通过右乘列向量即
        $$
        A\begin{pmatrix}
            1 \\
            \vdots \\
            1
        \end{pmatrix} = \lambda \begin{pmatrix}
            1 \\
            \vdots \\
            1
        \end{pmatrix} \iff \begin{pmatrix}
            1 \\
            \vdots \\
            1
        \end{pmatrix} \text{为}A\text{的特征值为}\lambda\text{的特征向量}
        $$ 
        (各列元素之和为$\lambda$)通过做成行向量即
        $$
        \left(1,\ldots,1\right)A=\lambda\left(1,\ldots,1\right)
        $$
    \end{tcolorbox}
    \item 设 $ A = (a_{ij}) $ 为 $ n(n \geq 3) $ 阶非零矩阵,$ A_{ij} $ 为 $ a_{ij} $ 的代数余子式,证明：
    \begin{enumerate}
        \item[(1)] $ a_{ij} = A_{ij}(i, j = 1, 2, \cdots, n) \Leftrightarrow A^* = A^T \Leftrightarrow AA^T = E $ 且 $ |A| = 1 $；
        \item[(2)] $ a_{ij} = -A_{ij}(i, j = 1, 2, \cdots, n) \Leftrightarrow A^* = -A^T \Leftrightarrow AA^T = E $ 且 $ |A| = -1 $.
    \end{enumerate}
    
    \begin{solution}
    {\color{red} 这道题的结论比较重要} 第一个充要条件通过定义即可证明即
    $$
    A^{*}=\begin{pmatrix}
        A_{11} &\ldots & A_{n1} \\
        \vdots &\ldots & \vdots \\
        A_{1n} &\ldots & A_{nn} 
    \end{pmatrix} = \begin{pmatrix}
        a_{11} &\ldots & a_{n1} \\
        \vdots &\ldots & \vdots \\
        a_{1n} &\ldots & a_{nn} 
    \end{pmatrix} = A^{T}
    $$
    下面证明第二个充要条件. \\
    右推左, 由于$AA^T=E$且$\left|A\right|=1$ 则
    $$
    A^{*}=\left|A\right|A^{-1}=A^{-1}=A^{T}
    $$
    左推右,由$A^{*}=A^{T}$则$\left|A^*\right|=\left|A\right|^{n-1}=\left|A^{T}\right|=\left|A\right|$ 从而
    $\left|A\right|=0,1,-1$ \\
    由于$A\neq O$,不妨设$a_11\neq 0$,按第一行展开有
    $$
    \left|A\right| = a_{11}A_{11} + \ldots a_{1n}A_{1n} = \sum_{i=1}^{n}a_{ii}^2 > 0 \implies \left|A\right| = 1
    $$
    又
    $$
    AA^{T}=AA^*=\left|A\right|E=E
    $$
    \end{solution}
\end{enumerate}

\section{初等变换与初等矩阵}
\begin{remark}[初等变换与初等矩阵的性质]
    \begin{enumerate}
    \item [(1)] $\left|E(i,j)\right|=-1,\left|E(i(k))\right|=k,\left|E(ij(k))\right|=1$
    \item [(2)] $E(i, j)^T=E(i,j),E(i(k))^T=E(i(k)),E(ij(k))^T=E(ji(k))$
    \item [(3)] $E(i,j)^{-1}=E(i,j),E(i(k))^{-1}=E(i(\frac{1}{k})),E(ij(k)^{-1})=E(ij(-k))$
    \item [(4)] 初等行(列)变换相当于左(乘)对应的初等矩阵
    \item [(5)] 可逆矩阵可以写成有限个初等矩阵的乘积
    \end{enumerate}
\end{remark}
\begin{enumerate}[label=\arabic*.,start=11]
    \item (2005, 数一、二) 设 $ A $ 为 $ n(n \geq 2) $ 阶可逆矩阵,交换 $ A $ 的第 1 行与第 2 行得到矩阵 $ B $,则：
    \begin{enumerate}
        \item [(A)] 交换 $ A^* $ 的第 1 列与第 2 列,得 $ B^* $
        \item [(B)] 交换 $ A^* $ 的第1行与第2行,的$B^*$
        \item [(C)] 交换 $ A^* $ 的第 1 列与第 2 列,得 $ -B^* $
        \item [(D)] 交换 $ A $ 的第 1 行与第 2 行,得 $ -B^* $
    \end{enumerate}
    
    \begin{solution}
    有题设有
    $$
        E(1,2)A = B 
    $$
    即
    \begin{align*}
        B^* &= A^*\left[E(1,2)\right]^* \\
        &=A^*\left|E(1,2)\right|E^{-1}(1,2) \\
        &=-A^*E(1,2)
    \end{align*}
    即交换 $ A^* $ 的第 1 列与第 2 列,得 $ -B^* $
    \end{solution}
\end{enumerate}

\ifx\allfiles\undefined
\end{document}
\fi